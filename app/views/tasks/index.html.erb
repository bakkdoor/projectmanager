<h1>Aufgaben</h1>

<div class="sub_menu">
  <%= link_to 'Neue Aufgabe anlegen', new_task_path %>
</div>

<div class="content_table">
  <table>
    <tr>
      <th>Name</th>
      <th><%= icon_tag 'layout_content' %> Projekt</th>
      <th><%= icon_tag 'note' %> Kommentar / Beschreibung</th>
      <th width="130px"><%= icon_tag 'time' %> Arbeitszeit</th>
      <th width="80px"><%= icon_tag 'tick' %> Status</th>
      <th><%= icon_tag 'clock_red' %> FÃ¤llig am</th>
    </tr>

  <% for task in @tasks %>
  <% 
    amount_children = task.children.size
    children_info = amount_children > 0 ? "(#{amount_children})" : "" 
  %>
    <tr>
      <td><%= link_to h("#{task.name} #{children_info}"), task %></td>
      <td><%= link_to h(task.project.name), task.project %></td>
      <td><%=h task.comment %></td>
      <td><%= task.total_worktime %> h (<%= task.worktimes.size %>)</td>
      <td><%=h Status.find(task.status) %></td>
      <td><%=h task.due_date %></td>
      <td><%= link_to icon_tag('table_edit'), edit_task_path(task) %></td>
      <td><%= link_to icon_tag('table_delete'), task, :confirm => 'Sind Sie sicher?', :method => :delete %></td>
    </tr>
  <% end %>
  </table>
</div>
